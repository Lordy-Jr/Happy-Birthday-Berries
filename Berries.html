<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>✨ Happy Birthday, My Berries 🌸</title>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500&display=swap" rel="stylesheet">
  <!-- Swiper.js for slideshow -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Crimson Pro', serif;
      background-color: #111133;
      color: #ffffff;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      text-align: center;
      overflow-x: hidden;
    }

    h1 {
      font-size: 2.5rem;
      margin-top: 1.8rem;
      color: #d6336c;
      z-index: 2;
    }

    .poem {
      max-width: 700px;
      padding: 1.5rem;
      font-size: 1.25rem;
      line-height: 1.8;
      margin-top: 1.5rem;
      margin-bottom: 1.5rem;
      z-index: 2;
    }

    .poem p {
      opacity: 0;
      animation: reveal 1s ease-in-out forwards;
    }

    .poem p:nth-child(1) { animation-delay: 0.5s; }
    .poem p:nth-child(2) { animation-delay: 2.5s; }
    .poem p:nth-child(3) { animation-delay: 4.5s; }
    .poem p:nth-child(4) { animation-delay: 6.5s; }

    @keyframes reveal {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .signature {
      margin-top: 1.5rem;
      font-weight: 600;
      font-size: 1.1rem;
      z-index: 2;
      animation: reveal 1s ease-in-out forwards;
      animation-delay: 8.5s;
      opacity: 0;
    }

    .photo-heart {
      position: relative;
      width: 250px;
      height: 220px;
      margin: 2rem auto;
      clip-path: path('M 125 200 C 0 120, 0 40, 125 70 C 250 40, 250 120, 125 200 Z');
      animation: subtlePulse 4s infinite ease-in-out;
      z-index: 2;
    }

    .photo-heart::before,
.photo-heart::after {
  content: "";
  position: absolute;
  width: 200px;
  height: 180px;
  background: red;
  border-radius: 50%;
}

.photo-heart::before {
  top: -100px;
  left: 0;
}

.photo-heart::after {
  left: 100px;
  top: 0;
}

    .heart-photo {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 10px;
    }

    @keyframes floatPhotos {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(10px, 20px); }
    }

    @keyframes floatInHeart {
      0% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
      100% { transform: translateY(0); }
    }

    /* Subtle Pulse Animation */
    @keyframes subtlePulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.02);
      }
    }


    /* Balloons */
    #balloon-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: 1;
    }

    .balloon {
      position: absolute;
      bottom: 0;
      width: 30px;
      height: 40px;
      border-radius: 50% 50% 50% 50%;
      animation: float 5s ease-in forwards;
    }

    @keyframes float {
      0% { transform: translateY(0) scale(1); opacity: 1; }
      80% { transform: translateY(-80vh) scale(1.2); }
      100% { transform: translateY(-100vh) scale(1.4); opacity: 0; }
    }

    .confetti, .heart {
      position: absolute;
      width: 10px;
      height: 10px;
      animation: fall 3s linear forwards;
      z-index: 2;
    }

    .heart::before, .heart::after {
      content: "";
      position: absolute;
      width: 10px;
      height: 16px;
      background: red;
      border-radius: 10px 10px 0 0;
    }

    .heart::before {
      transform: rotate(-45deg);
      left: 0;
    }

    .heart::after {
      transform: rotate(45deg);
      right: 0;
    }

    @keyframes fall {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }

    /* Footer */
    .footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #555;
      z-index: 2;
      opacity: 0;
      animation: fadeIn 2s ease-in-out 10s forwards;
      margin-bottom: 2rem;
    }

    .footer p {
      font-size: 0.9rem;
      opacity: 0.6;
    }
    
    /* Constellation Styles */
    .constellation-container {
      width: 100%;
      display: flex;
      justify-content: center;
      margin-top: 4rem;
    }

    .constellation-wrapper {
      background: linear-gradient(to bottom, #1a1037, #2b1b49);
      border-radius: 15px;
      padding: 2rem;
      margin: 3rem auto;
      max-width: 700px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transform: translateY(50px);
      transition: opacity 1.5s ease, transform 1.5s ease;
    }
  
    /* Special animation for twinkling stars in constellation */
    .star.twinkle {
      fill: #fff;
      animation: starTwinkle 3s infinite alternate;
    }
  
    @keyframes starTwinkle {
      0% { opacity: 0.3; r: 1.0; fill: #ffffff; }
      50% { opacity: 1; r: 1.5; fill: #fffce0; }
      100% { opacity: 0.7; r: 1.2; fill: #ffeeff; }
    }

    .constellation {
      width: 300px;
      height: 200px;
      stroke: #ffffffd9;
      fill: none;
      stroke-width: 1.5;
      transition: transform 0.2s ease;
    }

    .star {
      fill: #ffffee;
      animation: twinkle 2.5s infinite ease-in-out;
      filter: drop-shadow(0 0 3px rgba(255, 255, 200, 0.8));
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; transform: scale(1.2); }
    }

    .constellation-wrapper.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    .constellation-caption {
      color: #fff7cb;
      font-family: 'Cursive', 'Dancing Script', sans-serif;
      font-size: 1.3rem;
      margin-top: 1rem;
      text-align: center;
      letter-spacing: 1px;
      opacity: 0.95;
      animation: fadeInStars 2s ease forwards;
      animation-delay: 1.2s;
      text-shadow: 0 0 5px rgba(255, 255, 150, 0.5);
    }

    @keyframes fadeInStars {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 0.85; transform: translateY(0); }
    }
    
    .twinkle-word {
      animation: twinkle 3s infinite ease-in-out;
    }
    
    /* Voice Message Button */
    .voice-message {
      text-align: center;
      margin-top: 2rem;
    }

    .voice-message button {
      background: #ffb6c1;
      color: #fff;
      border: none;
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      border-radius: 1rem;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: background 0.3s ease;
    }

    .voice-message button:hover {
      background: #ff69b4;
    }
    
    .handwritten-note {
      font-family: 'Dancing Script', cursive;
      background: #fff8f0;
      border: 2px solid #f3d6c6;
      border-radius: 12px;
      padding: 1.5rem;
      margin: 4rem auto 2rem;
      max-width: 600px;
      font-size: 1.4rem;
      color: #5e4435;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.05);
    }
    
    .moon-phases {
      display: flex;
      justify-content: center;
      align-items: center;
      overflow-x: auto;
      gap: 1.5rem;
      padding: 2rem 1rem;
      margin-top: 2rem;
      background: #f9f6f2;
      border-top: 2px dashed #eee;
      border-bottom: 2px dashed #eee;
    }
    
    .moon-phase {
      text-align: center;
      flex: 0 0 auto;
      opacity: 0;
      transform: translateY(40px);
      animation: fadeInUp 1s forwards;
      animation-play-state: paused;
    }
    
    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .moon-phase img {
      width: 60px;
      height: 60px;
      object-fit: contain;
      margin-bottom: 0.5rem;
      filter: brightness(1.1);
    }
    
    .moon-phase p {
      font-family: 'Crimson Pro', serif;
      font-size: 1rem;
      color: #333;
    }

    .footer p span.heart {
      display: inline-block;
      animation: pulse 1.5s infinite ease-in-out;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 0.8; }
      50% { transform: scale(1.2); opacity: 1; }
    }

    @keyframes fadeIn {
      to { opacity: 0.6; }
    }

    .falling-heart {
  position: fixed;
  top: -30px;
  font-size: 24px;
  color: #ff4d6d;
  animation: fall 6s linear infinite;
  z-index: 2;
  pointer-events: none;
}

@keyframes fall {
  to {
    transform: translateY(100vh) rotate(360deg);
    opacity: 0;
  }
}

/* Twinkling Stars */
.stars-container {
  position: fixed;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
  z-index: 0;
}

.star {
  position: absolute;
  background-color: #fff;
  border-radius: 50%;
  opacity: 0;
  animation: twinkle 5s infinite;
}

@keyframes twinkle {
  0% { opacity: 0; }
  50% { opacity: 1; }
  100% { opacity: 0; }
}

/* Yellow twinkling stars animation */
@keyframes yellowTwinkle {
  0% { opacity: 0.3; transform: scale(1); box-shadow: 0 0 2px #fff4a3; }
  25% { opacity: 0.8; transform: scale(1.1); box-shadow: 0 0 6px #ffeb3b; }
  50% { opacity: 1; transform: scale(1.2); box-shadow: 0 0 8px #ffde59; }
  75% { opacity: 0.8; transform: scale(1.1); box-shadow: 0 0 6px #ffeb3b; }
  100% { opacity: 0.3; transform: scale(1); box-shadow: 0 0 2px #fff4a3; }
}

.moon-star {
  position: absolute;
  background-color: #fffcdb;
  border-radius: 50%;
  animation: yellowTwinkle 3s infinite;
  z-index: 1;
}

/* Gift Box */
.gift-box {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 80px;
  height: 80px;
  cursor: pointer;
  z-index: 10;
  transform-style: preserve-3d;
  perspective: 1000px;
}

.gift-box .box {
  width: 100%;
  height: 100%;
  background-color: #ff4d6d;
  border: 3px solid #d6336c;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.5s;
}

.gift-box .lid {
  position: absolute;
  width: 100%;
  height: 30px;
  top: -30px;
  background-color: #ff4d6d;
  border: 3px solid #d6336c;
  border-bottom: none;
  transform-origin: bottom;
  transition: transform 0.5s;
}

.gift-box .ribbon {
  position: absolute;
  width: 20px;
  height: 50px;
  background-color: #ffd43b;
  top: -50px;
  left: calc(50% - 10px);
  z-index: 2;
}

.gift-box.open .lid {
  transform: rotateX(-110deg);
}

.gift-box .message {
  position: absolute;
  top: -100px;
  left: 50%;
  transform: translateX(-50%);
  width: 150px;
  padding: 10px;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
  text-align: center;
  opacity: 0;
  transition: opacity 0.5s;
  pointer-events: none;
}

.gift-box.open .message {
  opacity: 1;
}

/* Virtual Candle */
.candle-container {
  position: fixed;
  bottom: 30px;
  left: 30px;
  width: 100px;
  height: 150px;
  cursor: pointer;
  z-index: 10;
}

.cake {
  width: 120px;
  height: 100px;
  position: relative;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  cursor: pointer;
}

.cake-base {
  width: 100%;
  height: 60px;
  background: linear-gradient(to bottom, #ff9dc4, #ff7eb5);
  border-radius: 8px 8px 60px 60px;
  position: absolute;
  bottom: 0;
  z-index: 1;
}

.cake-middle {
  width: 90%;
  height: 35px;
  background: linear-gradient(to bottom, #ffc4e0, #ffb2d4);
  border-radius: 6px 6px 40px 40px;
  position: absolute;
  bottom: 55px;
  left: 5%;
  z-index: 2;
}

.cake-top {
  width: 70%;
  height: 25px;
  background: linear-gradient(to bottom, #ffe0f0, #ffc9e4);
  border-radius: 5px 5px 30px 30px;
  position: absolute;
  bottom: 85px;
  left: 15%;
  z-index: 3;
}

.frosting {
  position: absolute;
  background: #fff5f9;
  border-radius: 50%;
  z-index: 4;
}

.frosting-1 { width: 15px; height: 10px; top: 88px; left: 20px; }
.frosting-2 { width: 12px; height: 8px; top: 90px; left: 45px; }
.frosting-3 { width: 14px; height: 9px; top: 89px; left: 75px; }
.frosting-4 { width: 13px; height: 8px; top: 52px; left: 30px; }
.frosting-5 { width: 11px; height: 7px; top: 54px; left: 65px; }
.frosting-6 { width: 12px; height: 9px; top: 25px; left: 50px; }

.sprinkle {
  position: absolute;
  width: 4px;
  height: 2px;
  border-radius: 1px;
  z-index: 5;
  transform: rotate(var(--rotation, 45deg));
}

.sprinkle-1 { background: #ffde59; top: 93px; left: 35px; --rotation: 30deg; }
.sprinkle-2 { background: #59b4ff; top: 87px; left: 60px; --rotation: -20deg; }
.sprinkle-3 { background: #ff5eb3; top: 58px; left: 48px; --rotation: 45deg; }
.sprinkle-4 { background: #a158ff; top: 50px; left: 80px; --rotation: 10deg; }
.sprinkle-5 { background: #4dff8e; top: 25px; left: 40px; --rotation: -35deg; }
.sprinkle-6 { background: #ff8459; top: 30px; left: 70px; --rotation: 15deg; }

.candle {
  width: 8px;
  height: 30px;
  background: linear-gradient(to right, #ffea00, #ffdd00);
  position: absolute;
  top: -30px;
  left: 56px;
  border-radius: 4px;
  z-index: 10;
}

.flame {
  width: 12px;
  height: 18px;
  background: radial-gradient(#ffdd00, #ff9500);
  border-radius: 50% 50% 20% 20%;
  position: absolute;
  top: -18px;
  left: -2px;
  filter: blur(1px);
  transform-origin: bottom center;
  animation: flicker 0.5s ease-in-out infinite alternate;
  z-index: 11;
}

.flame.out {
  animation: blow-out 0.5s forwards;
}

@keyframes flicker {
  0% {
    transform: scaleX(1) scaleY(1);
    filter: blur(1px);
  }
  100% {
    transform: scaleX(0.9) scaleY(1.1);
    filter: blur(2px);
  }
}

@keyframes blow-out {
  0% {
    transform: scaleX(1) scaleY(1);
    opacity: 1;
    filter: blur(1px);
  }
  50% {
    transform: scaleX(0.5) scaleY(1.5);
    opacity: 0.7;
    filter: blur(4px);
  }
  100% {
    transform: scaleX(0.1) scaleY(0.1);
    opacity: 0;
    filter: blur(5px);
  }
}

.smoke {
  position: absolute;
  width: 8px;
  height: 10px;
  background: rgba(200, 200, 200, 0.4);
  border-radius: 50%;
  top: -10px;
  left: 0;
  filter: blur(4px);
  animation: rise-smoke 2s forwards;
  z-index: 10;
}

@keyframes rise-smoke {
  0% {
    opacity: 0.7;
    transform: translateY(0) scale(1);
  }
  50% {
    opacity: 0.5;
    transform: translateY(-15px) scale(1.8) translateX(5px);
  }
  100% {
    opacity: 0;
    transform: translateY(-30px) scale(2.5) translateX(-5px);
  }
}

/* Special firework effect when blowing out candle */
.firework {
  position: absolute;
  width: 10px; /* Larger size */
  height: 10px; /* Larger size */
  border-radius: 50%;
  background: white;
  opacity: 0;
  z-index: 1000;
  pointer-events: none;
  transform: translate(-50%, -50%);
}

.particle {
  position: absolute;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  opacity: 1;
  z-index: 1000;
  pointer-events: none;
  transform: translate(-50%, -50%);
  box-shadow: 0 0 8px 2px rgba(255, 255, 255, 0.6);
}

@keyframes explode {
  0% {
    transform: translate(-50%, -50%) scale(0.1);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  50% {
    transform: translate(-50%, -50%) scale(25); /* Larger explosion */
    opacity: 0.8;
  }
  100% {
    transform: translate(-50%, -50%) scale(40); /* Even larger at the end */
    opacity: 0;
  }
}

.particle {
  position: absolute;
  width: 8px; /* Larger particles */
  height: 8px; /* Larger particles */
  border-radius: 50%;
  pointer-events: none;
  z-index: 1000;
  box-shadow: 0 0 8px 2px rgba(255, 255, 255, 0.6); /* Enhanced glow effect */
  transform: translate(-50%, -50%);
}

@keyframes shoot {
  0% {
    transform: translate(0, 0) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(var(--endX), var(--endY)) scale(0.5);
    opacity: 0;
  }
}

@keyframes fade-out {
  0% {
    transform: translate(0, 0);
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

@keyframes flicker {
  0% { transform: scaleY(1) rotate(-2deg); }
  50% { transform: scaleY(1.1) rotate(2deg); }
  100% { transform: scaleY(0.9) rotate(-1deg); }
}

.flame.out {
  animation: blow-out 0.5s forwards;
}

@keyframes blow-out {
  0% { opacity: 1; transform: scale(1); }
  100% { opacity: 0; transform: scale(0); }
}

.blow-effect {
  position: absolute;
  width: 100px;
  height: 50px;
  background-color: rgba(255,255,255,0.2);
  filter: blur(20px);
  border-radius: 50%;
  top: -30px;
  left: -45px;
  opacity: 0;
  transform: scale(0);
}

.blow-effect.active {
  animation: blow 0.5s forwards;
}

@keyframes blow {
  0% { opacity: 0; transform: scale(0); }
  50% { opacity: 0.8; transform: scale(1.5) translateX(20px); }
  100% { opacity: 0; transform: scale(2) translateX(40px); }
}

/* Floating Messages */
.floating-message {
  position: fixed;
  font-size: 1.2rem;
  color: #d6336c;
  opacity: 0;
  pointer-events: none;
  text-shadow: 0 0 5px #fff;
  animation: float-up 8s ease-in-out forwards;
  z-index: 3;
}

@keyframes float-up {
  0% { opacity: 0; transform: translateY(20px); }
  10% { opacity: 1; }
  80% { opacity: 0.8; }
  100% { opacity: 0; transform: translateY(-100px); }
}

/* Magic Words */
.magic-word {
  display: inline-block;
  position: relative;
  cursor: pointer;
}

.magic-word:hover {
  color: #ff4d6d;
}

.magic-word::after {
  content: '';
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  background-image: url("data:image/svg+xml,%3Csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle%20cx='10'%20cy='10'%20r='1'%20fill='%23ffea00'/%3E%3C/svg%3E");
  background-size: 20px 20px;
  opacity: 0;
  transition: opacity 0.3s;
  pointer-events: none;
}

.magic-word:hover::after {
  opacity: 1;
  animation: sparkle 1.5s infinite;
}

@keyframes sparkle {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

/* Custom Audio Player */
.audio-player {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 250px;
  margin: 20px auto;
  background: rgba(255, 255, 255, 0.8);
  padding: 10px;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  z-index: 5;
}

.audio-controls {
  display: flex;
  align-items: center;
  width: 100%;
  margin-top: 10px;
}

.play-btn {
  background: #ff4d6d;
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  margin-right: 10px;
  transition: background 0.2s;
}

.play-btn:hover {
  background: #d6336c;
}

.progress-container {
  flex-grow: 1;
  background: #f1f3f5;
  height: 6px;
  border-radius: 3px;
  overflow: hidden;
  cursor: pointer;
}

.progress-bar {
  height: 100%;
  background: #ff8787;
  width: 0;
}

.volume-container {
  display: flex;
  align-items: center;
  margin-left: 10px;
}

.volume-btn {
  background: none;
  border: none;
  color: #495057;
  cursor: pointer;
  transition: color 0.2s;
}

.volume-btn:hover {
  color: #ff4d6d;
}

.volume-slider {
  width: 60px;
  margin-left: 5px;
}

/* Memory Slideshow */
/* Photo Container Styles */
.photo-container {
  width: 300px;
  height: 300px;
  margin: 30px auto;
  z-index: 1;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 10px 20px rgba(0,0,0,0.1);
}

.single-photo {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 15px;
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
  h1 {
    font-size: 2rem;
  }
  
  .poem {
    font-size: 1rem;
    padding: 1rem;
  }
  
  .photo-heart {
    width: 160px;
    height: 140px;
  }
  
  .photo-container {
    width: 250px;
    height: 250px;
  }
  
  .audio-player {
    width: 200px;
  }
  
  .gift-box, .candle-container {
    transform: scale(0.8);
  }
}
  /* Using the new shooting-stars canvas instead */
  
  #shooting-stars {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; /* Behind everything */
    pointer-events: none;
  }

  .glow-trail {
    position: fixed;
    width: 12px;
    height: 12px;
    background: radial-gradient(circle, #ffd6f9 0%, #ff99dd 80%, transparent 100%);
    border-radius: 50%;
    pointer-events: none;
    animation: fadeOut 1s ease-out forwards;
    z-index: 9999;
  }

  @keyframes fadeOut {
    to {
      opacity: 0;
      transform: scale(1.5);
    }
  }

  .love-note {
    position: fixed;
    font-family: 'Crimson Pro', serif;
    font-size: 1.5rem;
    color: #ff3385;
    text-shadow: 0 0 5px #fff;
    opacity: 0;
    animation: floatNote 6s linear forwards;
    pointer-events: none;
    z-index: 9999;
    white-space: nowrap;
    background-color: rgba(255, 255, 255, 0.2);
    padding: 8px 12px;
    border-radius: 8px;
    font-weight: bold;
    box-shadow: 0 0 10px rgba(255, 200, 230, 0.5);
  }

  @keyframes floatNote {
    0% {
      transform: translateY(0) scale(0.9);
      opacity: 0;
    }
    10% {
      opacity: 1;
    }
    50% {
      opacity: 1;
      transform: translateY(-120px) scale(1.05);
    }
    80% {
      opacity: 0.8;
      transform: translateY(-200px) scale(1.05);
    }
    100% {
      opacity: 0;
      transform: translateY(-250px) scale(1.1);
    }
  }
  
  /* New love notes container */
  #love-notes-container {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 10;
  }
  
  /* New floating love note style */
  #love-notes-container .love-note {
    position: absolute;
    bottom: 0;
    font-family: 'Crimson Pro', serif;
    font-size: 1rem;
    color: #ff5c8d;
    opacity: 0.9;
    animation: floatNote 8s linear forwards;
    white-space: nowrap;
    text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
    background-color: rgba(255, 255, 255, 0.1);
    padding: 5px 10px;
    border-radius: 10px;
  }
  
  @keyframes floatNote {
    0% {
      transform: translateY(0) translateX(0);
      opacity: 1;
    }
    100% {
      transform: translateY(-100vh) translateX(30px);
      opacity: 0;
    }
  }

  .parallax-layer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 200vh;
    background-repeat: repeat;
    background-size: cover;
    pointer-events: none;
    z-index: -3;
    opacity: 0.4;
  }

  .parallax-layer.stars {
    background-image: url('https://www.transparenttextures.com/patterns/stardust.png');
  }

  .parallax-layer.moons {
    background-image: radial-gradient(circle at 30% 30%, #fbeaff 10%, transparent 40%),
                    radial-gradient(circle at 70% 80%, #e3d4ff 8%, transparent 40%);
    opacity: 0.2;
  }

  .crystal-moon {
    position: absolute;
    top: 10%;
    left: 50%;
    transform: translateX(-50%);
    width: 300px;
    height: 300px;
    background: radial-gradient(circle at 50% 50%, #fff0f8, #e6d6f8 50%, transparent 80%);
    border-radius: 50%;
    box-shadow: 0 0 40px rgba(255, 255, 255, 0.4), 0 0 80px rgba(235, 209, 255, 0.3);
    animation: pulse-moon 5s ease-in-out infinite;
    z-index: -2;
    opacity: 0.3;
  }

  @keyframes pulse-moon {
    0% {
      transform: translateX(-50%) scale(1);
      opacity: 0.3;
    }
    50% {
      transform: translateX(-50%) scale(1.05);
      opacity: 0.5;
    }
    100% {
      transform: translateX(-50%) scale(1);
      opacity: 0.3;
    }
  }

  .gift-box-container {
    position: fixed;
    bottom: 50px;
    right: 50px;
    cursor: pointer;
    z-index: 10;
  }

  .gift-box {
    width: 80px;
    height: 80px;
    position: relative;
    animation: bounce 2s infinite;
  }

  .gift-box .lid,
  .gift-box .box-body {
    position: absolute;
    width: 100%;
    background-color: #d6336c;
    border-radius: 8px;
  }

  .gift-box .lid {
    height: 30%;
    top: 0;
    transform-origin: bottom;
    transition: transform 0.5s ease;
    background: #ffb3c1;
  }

  .gift-box .box-body {
    height: 70%;
    bottom: 0;
  }

  .gift-box.open .lid {
    transform: rotateX(100deg);
  }

  .gift-surprise {
    display: none;
    position: fixed;
    bottom: 160px;
    right: 50px;
    width: 340px;
    padding: 20px;
    background: #fff6f9;
    border-radius: 20px;
    box-shadow: 0 0 20px rgba(255, 105, 180, 0.3), 0 0 40px rgba(255, 182, 193, 0.2);
    text-align: center;
    z-index: 100;
    animation: pop-up 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    transform-origin: bottom right;
  }

  @keyframes pop-up {
    0% { transform: scale(0); opacity: 0; }
    60% { transform: scale(1.2); opacity: 1; }
    80% { transform: scale(0.95); opacity: 1; }
    100% { transform: scale(1); opacity: 1; }
  }

  .teddy-container {
    position: relative;
    width: 100%;
    height: auto;
    animation: tada 1.5s 0.5s ease-in-out;
    visibility: visible;
    overflow: hidden;
    border-radius: 12px;
  }
  
  @keyframes tada {
    0% { transform: scale(1); }
    10%, 20% { transform: scale(0.9) rotate(-3deg); }
    30%, 50%, 70%, 90% { transform: scale(1.1) rotate(3deg); }
    40%, 60%, 80% { transform: scale(1.1) rotate(-3deg); }
    100% { transform: scale(1) rotate(0); }
  }
  
  .teddy-image-wrapper {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .teddy-image {
    width: 100%;
    height: auto;
    border-radius: 12px;
    max-width: 100%;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    transition: transform 0.3s ease;
  }
  
  .teddy-image:hover {
    transform: scale(1.02);
  }
  
  .heart-message-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -30%);
    z-index: 10;
    width: 45%;
    pointer-events: none;
  }

  @keyframes beat {
    0% { transform: translateX(-50%) scale(1); }
    50% { transform: translateX(-50%) scale(1.1); }
    100% { transform: translateX(-50%) scale(1); }
  }

  .heart-message {
    position: relative;
    font-family: 'Dancing Script', cursive;
    font-size: 1.1rem;
    color: white;
    font-weight: bold;
    text-align: center;
    z-index: 6;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7), 0 0 5px rgba(0, 0, 0, 0.5);
    background-color: rgba(255, 51, 102, 0.7);
    padding: 8px 12px;
    border-radius: 10px;
    line-height: 1.2;
    transform: rotate(-2deg);
    width: 100%;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }

  @keyframes bounce {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-8px);
    }
  }

  #sakura-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 2;
    overflow: hidden;
  }

  .sakura {
    position: absolute;
    width: 20px;
    height: 20px;
    background-image: url("data:image/svg+xml;utf8,<svg fill='%23ffb3c1' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'><path d='M12 2c.6 0 1 .4 1 1v2a1 1 0 1 1-2 0V3c0-.6.4-1 1-1Zm7.1 3.5a1 1 0 0 1 1.4 1.4l-1.5 1.5a1 1 0 1 1-1.4-1.4l1.5-1.5ZM12 18a6 6 0 0 0 6-6 6.1 6.1 0 0 0-.5-2.4l1.3-1.3a1 1 0 0 0-1.4-1.4L16.1 8a6 6 0 0 0-8.2 0L6.6 6.9a1 1 0 1 0-1.4 1.4L6.5 9.6A6.1 6.1 0 0 0 6 12a6 6 0 0 0 6 6Z'/></svg>");
    background-size: contain;
    background-repeat: no-repeat;
    opacity: 0.9;
    animation: fall 10s linear infinite, sway 4s ease-in-out infinite;
    z-index: 2;
  }

  @keyframes fall {
    0% {
      transform: translateY(-10vh) rotate(0deg);
      opacity: 1;
    }
    100% {
      transform: translateY(100vh) rotate(360deg);
      opacity: 0;
    }
  }

  @keyframes sway {
    0%, 100% {
      transform: translateX(0);
    }
    50% {
      transform: translateX(20px);
    }
  }
  /* SVG Moon in top left corner */
  .svg-moon-container {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 120px;
    height: 120px;
    z-index: 100;
    pointer-events: none;
  }
  
  .svg-moon {
    width: 100%;
    height: 100%;
    overflow: visible;
  }
  
  /* Animation for the moon glow */
  @keyframes moon-pulse {
    0% {
      filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.8));
      transform: scale(1);
    }
    50% {
      filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.9));
      transform: scale(1.03);
    }
    100% {
      filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.8));
      transform: scale(1);
    }
  }
  </style>
</head>
<body>
  <!-- SVG Moon in the top left corner -->
  <div class="svg-moon-container">
    <svg class="svg-moon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <!-- Base moon shape -->
      <circle cx="50" cy="50" r="40" fill="url(#moonGradient)" style="animation: moon-pulse 6s infinite ease-in-out;"/>
      
      <!-- Moon crater details -->
      <circle cx="35" cy="35" r="8" fill="rgba(220, 220, 230, 0.3)"/>
      <circle cx="70" cy="40" r="10" fill="rgba(220, 220, 230, 0.2)"/>
      <circle cx="50" cy="70" r="7" fill="rgba(220, 220, 230, 0.25)"/>
      <circle cx="25" cy="60" r="5" fill="rgba(220, 220, 230, 0.3)"/>
      <circle cx="65" cy="65" r="6" fill="rgba(220, 220, 230, 0.2)"/>
      
      <!-- Soft outer glow -->
      <circle cx="50" cy="50" r="45" fill="none" stroke="rgba(255, 255, 255, 0.3)" stroke-width="2">
        <animate attributeName="r" values="45;48;45" dur="6s" repeatCount="indefinite"/>
        <animate attributeName="stroke-opacity" values="0.3;0.6;0.3" dur="6s" repeatCount="indefinite"/>
      </circle>
      
      <!-- Gradient definition for the moon -->
      <defs>
        <radialGradient id="moonGradient" cx="40%" cy="40%" r="60%" fx="30%" fy="30%">
          <stop offset="0%" stop-color="#ffffff" />
          <stop offset="50%" stop-color="#f8f8ff" />
          <stop offset="90%" stop-color="#e0e0ea" />
          <stop offset="100%" stop-color="#d0d0e0" />
        </radialGradient>
      </defs>
    </svg>
  </div>
  
  <canvas id="shooting-stars"></canvas>
  <div id="sakura-container"></div>
  <div class="parallax-layer stars"></div>
  <div class="parallax-layer moons"></div>
  <div id="balloon-container"></div>
  <div class="stars-container"></div>
  
  <div class="crystal-moon"></div>
  <h1>✨ Happy Birthday, My <span class="magic-word">Berries</span> 🌸</h1>

  <div class="poem">
    <p>Today, the world quietly celebrates the day you arrived—<br>
    but my heart celebrates every day I get to love you.</p>
    <p>You are beauty in motion, kindness in bloom,<br>
    a soft place for my soul to rest,<br>
    and the spark that makes everything feel possible.</p>
    <p>Thank you for being my light, my calm,<br>
    my favorite thought, my best friend,<br>
    and the rarest kind of <span class="magic-word">magic</span>.</p>
    <p>I love you more than words ever learned to say.<br>
    Happy Birthday, my <span class="magic-word">Moon</span>. 🌙</p>
    <div class="signature">
      <p>Always yours,</p>
      <p><strong>Carrots 🥕</strong></p>
    </div>
    
    <div class="voice-message">
      <button onclick="toggleVoiceMessage()">🎙️ Play My Message</button>
      <audio id="voice-message" src="Public/audio/voice-message.mp3"></audio>
    </div>
  </div>

  <!-- Heart-Shaped Photo Display (Converted to Swiper) -->

  <!-- Single Photo Display -->
  <div class="photo-container">
    <img src="images/photo1.JPG" alt="photo1" class="single-photo">
  </div>

  <div class="footer">
    <p>Crafted with all my love just for you, <span class="magic-word">B</span> <span class="heart">❤️</span></p>
  </div>
  
  <!-- Birthday Candle -->
  <div class="candle-container">
    <div class="cake">
      <div class="candle">
        <div class="flame"></div>
      </div>
      <div class="blow-effect"></div>
    </div>
  </div>
  
  <!-- Gift Box removed to avoid duplication -->

  <!-- Custom Audio Player -->
  <div class="audio-player">
    <h3>Birthday Song</h3>
    <div class="audio-controls">
      <button class="play-btn"><i class="fas fa-play"></i></button>
      <div class="progress-container">
        <div class="progress-bar"></div>
      </div>
      <div class="volume-container">
        <button class="volume-btn"><i class="fas fa-volume-up"></i></button>
        <input type="range" class="volume-slider" min="0" max="1" step="0.1" value="0.7">
      </div>
    </div>
    <audio id="birthday-music" preload="metadata">
      <source src="Public/audio/happy-birthday.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>
    <audio id="ambient-audio" src="Public/audio/lullaby.mp3" loop></audio>
  </div>
  

  <!-- External Libraries -->
  <!-- Removed Swiper.js library as it's no longer needed -->
  
  <script>
    const colors = ['#ff4d6d', '#ffd43b', '#ffa94d', '#74c0fc', '#f783ac'];
    const balloonContainer = document.getElementById('balloon-container');

    function createBalloon() {
      const balloon = document.createElement('div');
      balloon.classList.add('balloon');
      balloon.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
      balloon.style.left = Math.random() * 100 + 'vw';
      balloon.style.animationDuration = 6 + Math.random() * 4 + 's';

      balloon.addEventListener('animationend', () => {
        balloon.remove();
        popConfetti(balloon.style.left);
        dropHearts(balloon.style.left);
      });

      balloonContainer.appendChild(balloon);
    }

    function popConfetti(x) {
      for (let i = 0; i < 12; i++) {
        const confetti = document.createElement('div');
        confetti.classList.add('confetti');
        confetti.style.left = `calc(${x} + ${Math.random() * 40 - 20}px)`;
        confetti.style.top = `${Math.random() * 10 + 10}px`;
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.borderRadius = '50%';
        balloonContainer.appendChild(confetti);
        confetti.addEventListener('animationend', () => confetti.remove());
      }
    }

    function dropHearts(x) {
      for (let i = 0; i < 6; i++) {
        const heart = document.createElement('div');
        heart.classList.add('heart');
        heart.style.left = `calc(${x} + ${Math.random() * 40 - 20}px)`;
        heart.style.top = `${Math.random() * 10 + 10}px`;
        balloonContainer.appendChild(heart);
        heart.addEventListener('animationend', () => heart.remove());
      }
    }

    setInterval(createBalloon, 1000);

    const photos = document.querySelectorAll('.heart-photo');
    photos.forEach(photo => {
      photo.addEventListener('mouseover', () => {
        photo.style.transform = 'scale(1.1)';
      });
      photo.addEventListener('mouseout', () => {
        photo.style.transform = 'scale(1)';
      });
    });

    // Play audio 3 seconds after page loads
    setTimeout(() => {
      const audio = document.getElementById('birthday-music');
      audio.play().catch(error => {
        console.log('Audio playback failed:', error);
        // Modern browsers require user interaction before autoplay
        // This is a fallback message if needed
      });
    }, 3000);

    // Photo slideshow is now handled by Swiper.js

    function createHeart() {
    const heart = document.createElement("div");
    heart.classList.add("falling-heart");
    heart.style.left = Math.random() * 100 + "vw";
    heart.textContent = "❤️";
    heart.style.animationDuration = 3 + Math.random() * 3 + "s";
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 6000);
  }

  setInterval(createHeart, 500); // creates a heart every 0.5 seconds
    
    // Twinkling Stars
    function createStars() {
      const starsContainer = document.querySelector('.stars-container');
      const starCount = 50;
      
      for(let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.classList.add('star');
        star.style.width = Math.random() * 3 + 1 + 'px';
        star.style.height = star.style.width;
        star.style.left = Math.random() * 100 + 'vw';
        star.style.top = Math.random() * 100 + 'vh';
        star.style.animationDelay = Math.random() * 5 + 's';
        star.style.animationDuration = Math.random() * 5 + 3 + 's';
        starsContainer.appendChild(star);
      }
    }
    
    // Floating Messages
    const messages = [
      'I love you, B ❤️',
      'You make life sweeter',
      'My moon, my magic',
      'Forever grateful for you',
      'You light up my world'
    ];
    
    function createFloatingMessage() {
      const message = document.createElement('div');
      message.classList.add('floating-message');
      message.innerText = messages[Math.floor(Math.random() * messages.length)];
      message.style.left = Math.random() * 80 + 10 + 'vw';
      message.style.top = Math.random() * 80 + 10 + 'vh';
      document.body.appendChild(message);
      
      setTimeout(() => message.remove(), 8000);
    }
    
    setInterval(createFloatingMessage, 4000);
    
    // Gift Box Animation
    const giftBox = document.querySelector('.gift-box');
    giftBox.addEventListener('click', () => {
      giftBox.classList.toggle('open');
      if(giftBox.classList.contains('open')) {
        // Emit confetti when opened
        for(let i = 0; i < 20; i++) {
          setTimeout(() => {
            popConfetti(giftBox.getBoundingClientRect().left + 'px');
          }, i * 100);
        }
      }
    });
    
    // Candle Blowing Animation
    const candle = document.querySelector('.candle-container');
    const flame = document.querySelector('.flame');
    const blowEffect = document.querySelector('.blow-effect');
    
    candle.addEventListener('click', () => {
      if(!flame.classList.contains('out')) {
        flame.classList.add('out');
        blowEffect.classList.add('active');
        
        // Celebration after blowing the candle
        setTimeout(() => {
          for(let i = 0; i < 30; i++) {
            setTimeout(() => {
              createHeart();
              if(i % 3 === 0) createFloatingMessage();
            }, i * 100);
          }
          
          // Add surprise message
          const surprise = document.createElement('div');
          surprise.style.position = 'fixed';
          surprise.style.top = '50%';
          surprise.style.left = '50%';
          surprise.style.transform = 'translate(-50%, -50%)';
          surprise.style.background = 'rgba(255,255,255,0.9)';
          surprise.style.padding = '20px';
          surprise.style.borderRadius = '10px';
          surprise.style.boxShadow = '0 0 20px rgba(0,0,0,0.2)';
          surprise.style.zIndex = '100';
          surprise.style.maxWidth = '300px';
          surprise.style.textAlign = 'center';
          surprise.innerHTML = `<h3>Make a wish!</h3><p>May all your dreams come true. I'll be right there with you ✨</p><button style="padding: 8px 15px; background: #ff4d6d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px;">Close</button>`;
          document.body.appendChild(surprise);
          
          surprise.querySelector('button').addEventListener('click', () => {
            surprise.remove();
          });
        }, 1000);
      }
    });
    
    // Initialize Swiper Slideshow
    const swiper = new Swiper('.swiper-container', {
      effect: 'fade',
      fadeEffect: { crossFade: true },
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      loop: true
    });
    
    // Custom Audio Player
    // Get references to audio elements and controls
    const audio = document.getElementById('birthday-music');
    const playBtn = document.querySelector('.play-btn');
    const progressContainer = document.querySelector('.progress-container');
    const progressBar = document.querySelector('.progress-bar');
    const volumeBtn = document.querySelector('.volume-btn');
    const volumeSlider = document.querySelector('.volume-slider');
    
    // Make sure audio has loaded metadata
    audio.addEventListener('loadedmetadata', () => {
      console.log('Audio metadata loaded');
    });
    
    // Play and Pause
    playBtn.addEventListener('click', function() {
      console.log('Play button clicked, audio paused state:', audio.paused);
      
      if(audio.paused) {
        // Play the audio
        console.log('Attempting to play audio');
        let playPromise = audio.play();
        
        if (playPromise !== undefined) {
          playPromise.then(() => {
            console.log('Audio playback started successfully');
            // Update button icon to pause
            playBtn.innerHTML = '<i class="fas fa-pause"></i>';
          }).catch(error => {
            console.log('Error playing audio:', error);
          });
        }
      } else {
        // Pause the audio
        console.log('Pausing audio');
        audio.pause();
        // Update button icon to play
        playBtn.innerHTML = '<i class="fas fa-play"></i>';
      }
    });
    
    // Update play button state when audio plays or pauses
    audio.addEventListener('play', () => {
      playBtn.innerHTML = '<i class="fas fa-pause"></i>';
    });
    
    audio.addEventListener('pause', () => {
      playBtn.innerHTML = '<i class="fas fa-play"></i>';
    });
    
    // Update Progress
    audio.addEventListener('timeupdate', () => {
      const progress = (audio.currentTime / audio.duration) * 100;
      progressBar.style.width = `${progress}%`;
      
      if(audio.ended) {
        playBtn.innerHTML = '<i class="fas fa-play"></i>';
      }
    });
    
    // Set Progress on Click
    progressContainer.addEventListener('click', (e) => {
      const width = progressContainer.clientWidth;
      const clickX = e.offsetX;
      const duration = audio.duration;
      
      audio.currentTime = (clickX / width) * duration;
    });
    
    // Set Volume
    volumeSlider.addEventListener('input', function() {
      console.log('Volume slider adjusted to:', volumeSlider.value);
      audio.volume = volumeSlider.value;
      
      // Apply the same volume to ambient audio if it's playing
      const ambientAudio = document.getElementById('ambient-audio');
      if (!ambientAudio.paused) {
        ambientAudio.volume = volumeSlider.value;
      }
      
      updateVolumeIcon();
    });
    
    // Toggle Mute
    volumeBtn.addEventListener('click', function() {
      console.log('Mute button clicked, current muted state:', audio.muted);
      audio.muted = !audio.muted;
      
      // Apply the same mute state to ambient audio
      const ambientAudio = document.getElementById('ambient-audio');
      ambientAudio.muted = audio.muted;
      
      updateVolumeIcon();
    });
    
    function updateVolumeIcon() {
      if(audio.muted || audio.volume === 0) {
        volumeBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
      } else if(audio.volume < 0.5) {
        volumeBtn.innerHTML = '<i class="fas fa-volume-down"></i>';
      } else {
        volumeBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
      }
    }
    
    // Play audio after 3 seconds
    setTimeout(() => {
      audio.play().catch(error => {
        console.log('Auto-play prevented by browser', error);
      });
      playBtn.innerHTML = '<i class="fas fa-pause"></i>';
    }, 3000);
    
    // Play ambient music after birthday song
    const birthdayAudio = document.getElementById('birthday-music');
    const ambientAudio = document.getElementById('ambient-audio');

    birthdayAudio.addEventListener('ended', () => {
      ambientAudio.volume = 0.4;
      ambientAudio.play();
    });
    
    // Initialize everything when page loads
    window.addEventListener('load', () => {
      createStars();
      updateVolumeIcon();
    });
    
    function toggleVoiceMessage() {
      const messageAudio = document.getElementById('voice-message');
      const birthdayAudio = document.getElementById('birthday-music');
      const ambientAudio = document.getElementById('ambient-audio');
      const playBtn = document.querySelector('.play-btn');
      
      console.log('Toggle voice message clicked, message paused state:', messageAudio.paused);
      
      // Store original states to restore later
      const originalBirthdayMuted = birthdayAudio.muted;
      const originalAmbientMuted = ambientAudio.muted;
      const originalBirthdayVolume = birthdayAudio.volume;
      const originalAmbientVolume = ambientAudio.volume;
      
      if (messageAudio.paused) {
        console.log('Starting voice message playback');
        // Set voice message to loud volume
        messageAudio.volume = 0.9;
        
        // Completely mute other audio
        birthdayAudio.muted = true;
        ambientAudio.muted = true;
        
        // Play the message
        let playPromise = messageAudio.play();
        
        if (playPromise !== undefined) {
          playPromise.then(() => {
            console.log('Voice message playback started successfully');
          }).catch(error => {
            console.log('Error playing voice message:', error);
            // Unmute other audio if voice message fails to play
            birthdayAudio.muted = originalBirthdayMuted;
            ambientAudio.muted = originalAmbientMuted;
          });
        }
        
        // Add event listener to restore audio when message ends
        messageAudio.addEventListener('ended', function restoreAudio() {
          console.log('Voice message ended, restoring audio');
          // Restore original muted states
          birthdayAudio.muted = originalBirthdayMuted;
          ambientAudio.muted = originalAmbientMuted;
          
          // Remove this event listener to prevent multiple bindings
          messageAudio.removeEventListener('ended', restoreAudio);
        });
      } else {
        console.log('Pausing voice message');
        // Pause the message
        messageAudio.pause();
        
        // Restore original audio states immediately
        birthdayAudio.muted = originalBirthdayMuted;
        ambientAudio.muted = originalAmbientMuted;
      }
    }
  </script>

  <div class="handwritten-note">
    <p>Dear B,</p>
    <p>
      I hope this little world I built brings a smile to your face.  
      I made every sparkle, star, petal, and sound for you.  
      You are my favorite story, my calmest moment, and the rhythm in my chest.
    </p>
    <p>
      Never forget how deeply and softly you're loved.
    </p>
    <p>
      Yours,  
      <span style="font-family: 'Crimson Pro', serif;">Carrots 🥕</span>
    </p>
  </div>
  
  <section id="moon-phases" style="text-align: center; margin: 80px auto; max-width: 800px; background: rgba(20, 20, 40, 0.9); padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); position: relative; overflow: hidden;">
    <!-- Yellow twinkling stars in the background -->
    <div class="moon-star" style="width: 3px; height: 3px; top: 10%; left: 5%; animation-delay: 0.3s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 15%; left: 12%; animation-delay: 1.1s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 8%; left: 25%; animation-delay: 0.7s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 20%; left: 30%; animation-delay: 1.5s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 12%; left: 45%; animation-delay: 0.2s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 5%; left: 55%; animation-delay: 1.3s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 18%; left: 65%; animation-delay: 0.8s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 22%; left: 75%; animation-delay: 1.7s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 15%; left: 85%; animation-delay: 0.5s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 10%; left: 92%; animation-delay: 1.2s;"></div>
    
    <div class="moon-star" style="width: 3px; height: 3px; top: 35%; left: 7%; animation-delay: 1.4s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 40%; left: 15%; animation-delay: 0.6s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 30%; left: 27%; animation-delay: 1.9s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 45%; left: 35%; animation-delay: 0.4s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 38%; left: 48%; animation-delay: 1.6s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 32%; left: 58%; animation-delay: 0.9s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 42%; left: 68%; animation-delay: 2.0s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 48%; left: 78%; animation-delay: 0.3s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 36%; left: 88%; animation-delay: 1.8s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 40%; left: 95%; animation-delay: 0.7s;"></div>
    
    <div class="moon-star" style="width: 3px; height: 3px; top: 65%; left: 8%; animation-delay: 1.0s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 70%; left: 18%; animation-delay: 2.1s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 60%; left: 28%; animation-delay: 0.5s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 75%; left: 38%; animation-delay: 1.3s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 68%; left: 52%; animation-delay: 0.8s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 62%; left: 62%; animation-delay: 1.9s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 72%; left: 72%; animation-delay: 0.4s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 78%; left: 82%; animation-delay: 1.5s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 66%; left: 90%; animation-delay: 0.6s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 80%; left: 96%; animation-delay: 1.2s;"></div>
    
    <div class="moon-star" style="width: 3px; height: 3px; top: 85%; left: 10%; animation-delay: 0.7s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 90%; left: 20%; animation-delay: 1.4s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 82%; left: 32%; animation-delay: 0.3s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 88%; left: 42%; animation-delay: 2.0s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 92%; left: 55%; animation-delay: 0.9s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 86%; left: 65%; animation-delay: 1.7s;"></div>
    <div class="moon-star" style="width: 3px; height: 3px; top: 94%; left: 75%; animation-delay: 0.2s;"></div>
    <div class="moon-star" style="width: 2px; height: 2px; top: 88%; left: 85%; animation-delay: 1.1s;"></div>
    <div class="moon-star" style="width: 4px; height: 4px; top: 90%; left: 92%; animation-delay: 0.8s;"></div>
    <h2 style="font-size: 1.8rem; color: #f8f9fa; margin-bottom: 30px;">Phases of You 🌙</h2>
    <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 40px;">

      <div class="moon-phase" style="animation-delay: 0s; text-align: center;">
        <svg width="60" height="60"><circle cx="30" cy="30" r="20" fill="#1a1a1a"/></svg>
        <p style="color: #eee; font-style: italic; margin-top: 8px;">New Moon<br><span style="font-size: 0.9rem;">Your mystery</span></p>
      </div>

      <div class="moon-phase" style="animation-delay: 0.3s; text-align: center;">
        <svg width="60" height="60"><circle cx="30" cy="30" r="20" fill="#1a1a1a"/><path d="M30 10 A20 20 0 1 1 30 50 A15 20 0 1 0 30 10" fill="#fff9c4"/></svg>
        <p style="color: #eee; font-style: italic; margin-top: 8px;">Crescent<br><span style="font-size: 0.9rem;">Your spark</span></p>
      </div>

      <div class="moon-phase" style="animation-delay: 0.6s; text-align: center;">
        <svg width="60" height="60"><circle cx="30" cy="30" r="20" fill="#1a1a1a"/><path d="M30 10 A20 20 0 1 1 30 50 L30 10" fill="#fff9c4"/></svg>
        <p style="color: #eee; font-style: italic; margin-top: 8px;">Quarter<br><span style="font-size: 0.9rem;">Your strength</span></p>
      </div>

      <div class="moon-phase" style="animation-delay: 0.9s; text-align: center;">
        <svg width="60" height="60"><circle cx="30" cy="30" r="20" fill="#fff9c4"/><path d="M30 10 A15 20 0 1 0 30 50 A20 20 0 1 1 30 10" fill="#1a1a1a"/></svg>
        <p style="color: #eee; font-style: italic; margin-top: 8px;">Gibbous<br><span style="font-size: 0.9rem;">Your wisdom</span></p>
      </div>

      <div class="moon-phase" style="animation-delay: 1.2s; text-align: center;">
        <svg width="60" height="60"><circle cx="30" cy="30" r="20" fill="#fff9c4"/></svg>
        <p style="color: #eee; font-style: italic; margin-top: 8px;">Full Moon<br><span style="font-size: 0.9rem;">Your radiance</span></p>
      </div>

    </div>
  </section>
  
  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const moonPhases = document.querySelectorAll(".moon-phase");

    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.animationPlayState = "running";
          observer.unobserve(entry.target); // animate once
        }
      });
    }, {
      threshold: 0.2,
    });

    moonPhases.forEach((el) => {
      el.style.animationPlayState = "paused"; // pause until visible
      observer.observe(el);
    });
  });
  </script>

  <!-- Constellation Animation -->
  <div class="constellation-wrapper" id="constellation-wrapper">
    <h3 style="color: #ffd3e0; margin-top: 0; margin-bottom: 1rem; font-family: 'Dancing Script', cursive; font-size: 1.8rem;">Eternal Gemini</h3>
    <svg viewBox="0 0 300 200" class="constellation" id="constellation">
      <!-- Main stars of Gemini constellation - Castor -->
      <circle class="star" cx="90" cy="40" r="2.5" /> <!-- Castor (α Geminorum) -->
      <circle class="star" cx="95" cy="60" r="2" /> <!-- Luyten -->
      <circle class="star" cx="85" cy="90" r="2" /> <!-- Tejat -->
      <circle class="star" cx="70" cy="120" r="2" /> <!-- Mebsuta -->
      <circle class="star" cx="95" cy="140" r="2" /> <!-- Mekbuda -->
      <circle class="star" cx="75" cy="170" r="2" /> <!-- Alhena -->

      <!-- Main stars of Gemini constellation - Pollux -->
      <circle class="star" cx="210" cy="40" r="2.5" /> <!-- Pollux (β Geminorum) -->
      <circle class="star" cx="205" cy="60" r="2" /> <!-- κ Geminorum -->
      <circle class="star" cx="215" cy="90" r="2" /> <!-- Wasat -->
      <circle class="star" cx="230" cy="120" r="2" /> <!-- δ Geminorum -->
      <circle class="star" cx="205" cy="140" r="2" /> <!-- ι Geminorum -->
      <circle class="star" cx="225" cy="170" r="2" /> <!-- λ Geminorum -->

      <!-- Connecting lines for Castor -->
      <line x1="90" y1="40" x2="95" y2="60" />
      <line x1="95" y1="60" x2="85" y2="90" />
      <line x1="85" y1="90" x2="70" y2="120" />
      <line x1="70" y1="120" x2="95" y2="140" />
      <line x1="95" y1="140" x2="75" y2="170" />

      <!-- Connecting lines for Pollux -->
      <line x1="210" y1="40" x2="205" y2="60" />
      <line x1="205" y1="60" x2="215" y2="90" />
      <line x1="215" y1="90" x2="230" y2="120" />
      <line x1="230" y1="120" x2="205" y2="140" />
      <line x1="205" y1="140" x2="225" y2="170" />

      <!-- Additional stars connecting the twins -->
      <line x1="85" y1="90" x2="215" y2="90" />
      <line x1="70" y1="120" x2="230" y2="120" />

      <!-- Additional small stars for background -->
      <circle class="star" cx="50" cy="30" r="1" />
      <circle class="star" cx="120" cy="25" r="1.2" />
      <circle class="star" cx="150" cy="55" r="1" />
      <circle class="star" cx="180" cy="30" r="1.2" />
      <circle class="star" cx="250" cy="35" r="1" />
      <circle class="star" cx="30" cy="60" r="1.2" />
      <circle class="star" cx="270" cy="70" r="1" />
      <circle class="star" cx="60" cy="80" r="0.8" />
      <circle class="star" cx="130" cy="75" r="1" />
      <circle class="star" cx="170" cy="85" r="0.8" />
      <circle class="star" cx="240" cy="95" r="1" />
      <circle class="star" cx="40" cy="110" r="0.8" />
      <circle class="star" cx="150" cy="105" r="1.2" />
      <circle class="star" cx="260" cy="115" r="0.8" />
      <circle class="star" cx="55" cy="135" r="1" />
      <circle class="star" cx="125" cy="130" r="0.8" />
      <circle class="star" cx="175" cy="125" r="1" />
      <circle class="star" cx="245" cy="145" r="0.8" />
      <circle class="star" cx="30" cy="155" r="1" />
      <circle class="star" cx="150" cy="160" r="0.8" />
      <circle class="star" cx="270" cy="165" r="1" />
      <circle class="star" cx="45" cy="180" r="0.8" />
      <circle class="star" cx="120" cy="185" r="1" />
      <circle class="star" cx="180" cy="175" r="0.8" />
      <circle class="star" cx="250" cy="180" r="1" />
      
      <!-- Additional stars to make constellation more vibrant -->
      <circle class="star" cx="15" cy="15" r="1.1" />
      <circle class="star" cx="35" cy="25" r="0.7" />
      <circle class="star" cx="65" cy="35" r="0.9" />
      <circle class="star" cx="140" cy="20" r="1.3" />
      <circle class="star" cx="190" cy="15" r="0.7" />
      <circle class="star" cx="220" cy="25" r="1.1" />
      <circle class="star" cx="280" cy="30" r="0.8" />
      <circle class="star" cx="15" cy="45" r="0.7" />
      <circle class="star" cx="45" cy="50" r="1.0" />
      <circle class="star" cx="110" cy="45" r="0.8" />
      <circle class="star" cx="160" cy="45" r="1.2" />
      <circle class="star" cx="195" cy="50" r="0.7" />
      <circle class="star" cx="280" cy="55" r="1.0" />
      <circle class="star" cx="20" cy="75" r="0.9" />
      <circle class="star" cx="155" cy="70" r="0.7" />
      <circle class="star" cx="190" cy="65" r="1.0" />
      <circle class="star" cx="245" cy="65" r="0.8" />
      <circle class="star" cx="290" cy="75" r="0.7" />
      <circle class="star" cx="25" cy="95" r="1.1" />
      <circle class="star" cx="100" cy="100" r="0.8" />
      <circle class="star" cx="285" cy="100" r="0.9" />
      <circle class="star" cx="15" cy="125" r="0.7" />
      <circle class="star" cx="110" cy="125" r="1.0" />
      <circle class="star" cx="135" cy="135" r="0.8" />
      <circle class="star" cx="185" cy="130" r="0.7" />
      <circle class="star" cx="255" cy="135" r="1.1" />
      <circle class="star" cx="10" cy="150" r="0.8" />
      <circle class="star" cx="65" cy="145" r="0.7" />
      <circle class="star" cx="165" cy="145" r="1.0" />
      <circle class="star" cx="280" cy="150" r="0.8" />
      <circle class="star" cx="25" cy="170" r="0.7" />
      <circle class="star" cx="140" cy="165" r="0.9" />
      <circle class="star" cx="195" cy="170" r="1.1" />
      <circle class="star" cx="265" cy="175" r="0.8" />
      <circle class="star" cx="95" cy="190" r="0.7" />
      <circle class="star" cx="155" cy="185" r="1.0" />
      <circle class="star" cx="210" cy="190" r="0.9" />
      <circle class="star" cx="275" cy="195" r="0.7" />
      
      <!-- Sparkle stars with animation -->
      <circle class="star twinkle" cx="100" cy="50" r="1.5" />
      <circle class="star twinkle" cx="200" cy="50" r="1.5" />
      <circle class="star twinkle" cx="150" cy="80" r="1.4" />
      <circle class="star twinkle" cx="50" cy="100" r="1.3" />
      <circle class="star twinkle" cx="250" cy="100" r="1.3" />
      <circle class="star twinkle" cx="150" cy="130" r="1.4" />
      <circle class="star twinkle" cx="100" cy="150" r="1.5" />
      <circle class="star twinkle" cx="200" cy="150" r="1.5" />
    </svg>
    <p class="constellation-caption">Written in the <span class="twinkle-word">stars ✨</span></p>
  </div>

  <script>
  // Scroll Reveal for Constellation
  const constellationWrapper = document.getElementById('constellation-wrapper');
  window.addEventListener('scroll', () => {
    const rect = constellationWrapper.getBoundingClientRect();
    if (rect.top < window.innerHeight * 0.85) {
      constellationWrapper.classList.add('visible');
    }
  });

  // Cursor-based parallax for constellation
  const constellation = document.getElementById('constellation');
  document.addEventListener('mousemove', (e) => {
    const x = (e.clientX / window.innerWidth - 0.5) * 10;
    const y = (e.clientY / window.innerHeight - 0.5) * 10;
    constellation.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
  });

  // Old shooting stars animation code removed to avoid conflicts with the new animation
  // Now using the new shooting-stars canvas animation at the bottom of the page

  document.addEventListener('mousemove', (e) => {
    const trail = document.createElement('div');
    trail.className = 'glow-trail';
    trail.style.left = `${e.clientX - 6}px`;
    trail.style.top = `${e.clientY - 6}px`;
    document.body.appendChild(trail);

    setTimeout(() => {
      trail.remove();
    }, 1000);
  });

  const loveMessages = [
    "You're my everything 💖",
    "Forever yours 🌙",
    "My berries 🍓",
    "Sweetest soul ✨",
    "Love you always ❤️",
    "My favorite hello 💌",
    "Made of magic 🌟",
    "Always your Carrots 🥕",
    "To the moon and back 🌕"
  ];

  function spawnLoveNote() {
    console.log('Spawning a love note...');
    const note = document.createElement('div');
    note.className = 'love-note';
    note.innerText = loveMessages[Math.floor(Math.random() * loveMessages.length)];
    
    // Position note appropriately - more centered and visible
    const windowWidth = window.innerWidth;
    note.style.left = (windowWidth / 2 - 100) + (Math.random() * 200) + 'px';
    note.style.bottom = '150px';
    
    // Add to DOM
    document.body.appendChild(note);
    
    // Force a reflow to ensure animation starts properly
    void note.offsetHeight;
    
    // Add a debug message in console
    console.log('Love note created and added to DOM:', note.innerText, 'at position:', note.style.left);
    
    // Remove after animation completes
    setTimeout(() => {
      note.remove();
      console.log('Love note removed from DOM');
    }, 6000);
  }

  // Interval moved to window.onload

  window.addEventListener('scroll', () => {
    const scrollY = window.scrollY;
    document.querySelector('.parallax-layer.stars').style.transform = `translateY(${scrollY * 0.3}px)`;
    document.querySelector('.parallax-layer.moons').style.transform = `translateY(${scrollY * 0.15}px)`;
  });

  function openGift() {
    const box = document.querySelector('.gift-box');
    const surprise = document.getElementById('gift-surprise');
    box.classList.toggle('open');
    
    if (surprise.style.display !== 'block') {
      // Play a cute sound when the gift opens
      const giftSound = new Audio('https://soundbible.com/mp3/Jingle%20Bells-SoundBible.com-647403987.mp3');
      giftSound.volume = 0.3;
      giftSound.play().catch(error => console.log('Could not play gift sound:', error));
      
      // Display the surprise
      surprise.style.display = 'block';
      
      // Add a small delay before the tada animation
      setTimeout(() => {
        const teddyContainer = document.querySelector('.teddy-container');
        if (teddyContainer) {
          teddyContainer.style.visibility = 'visible';
        }
      }, 300);
    } else {
      // Hide the surprise
      surprise.style.display = 'none';
    }
  }

  function createSakuraPetal() {
    const sakura = document.createElement('div');
    sakura.classList.add('sakura');
    sakura.style.left = Math.random() * 100 + 'vw';
    sakura.style.animationDuration = 5 + Math.random() * 5 + 's';
    document.getElementById('sakura-container').appendChild(sakura);

    setTimeout(() => {
      sakura.remove();
    }, 10000);
  }

  // Make sure all elements are properly initialized when DOM is fully loaded
  document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM fully loaded, initializing animations...');
    
    // Ensure moon is visible
    const crystalMoon = document.querySelector('.crystal-moon');
    if (crystalMoon) {
      crystalMoon.style.opacity = '0.3';
      console.log('Crystal moon initialized');
    }
    
    // Ensure containers exist
    const sakuraContainer = document.getElementById('sakura-container');
    if (!sakuraContainer) {
      console.error('Sakura container not found!');
    } else {
      console.log('Sakura container found, creating petals...');
      // Create initial sakura petals
      for (let i = 0; i < 15; i++) {
        createSakuraPetal();
      }
      // Start sakura petals interval
      setInterval(createSakuraPetal, 400);
    }
    
    // Initialize parallax layers
    const starsLayer = document.querySelector('.parallax-layer.stars');
    const moonsLayer = document.querySelector('.parallax-layer.moons');
    if (starsLayer && moonsLayer) {
      starsLayer.style.opacity = '0.4';
      moonsLayer.style.opacity = '0.2';
      console.log('Parallax layers initialized');
    }
    
    // Create a test love note immediately to verify it's working
    console.log('Creating test love note immediately...');
    spawnLoveNote();
    
    // Schedule the regular love notes to appear every 4 seconds
    setTimeout(() => {
      console.log('Starting regular love notes...');
      // Then continue creating them every 4 seconds
      setInterval(spawnLoveNote, 4000);
    }, 4000);
  });
  
  // Also use window.onload as a fallback
  window.onload = function() {
    console.log('Window loaded completely');
    
    // Double-check that moon and effects are visible
    const crystalMoon = document.querySelector('.crystal-moon');
    if (crystalMoon) {
      crystalMoon.style.opacity = '0.3';
    }
    
    const starsLayer = document.querySelector('.parallax-layer.stars');
    const moonsLayer = document.querySelector('.parallax-layer.moons');
    if (starsLayer && moonsLayer) {
      starsLayer.style.opacity = '0.4';
      moonsLayer.style.opacity = '0.2';
    }
  };
  </script>
  <!-- Using the new shooting-stars canvas instead -->

  <div class="gift-box-container">
    <div class="gift-box" onclick="openGift()">
      <div class="lid"></div>
      <div class="box-body"></div>
    </div>
    <div class="gift-surprise" id="gift-surprise">
      <div class="teddy-container">
        <div class="teddy-image-wrapper">
          <img src="https://thumbs.dreamstime.com/b/white-teddy-bear-hugging-red-heart-art-mode-white-teddy-bear-hugging-red-heart-303889174.jpg" alt="White teddy bear hugging a red heart" class="teddy-image">
          <div class="heart-message-overlay">
            <p class="heart-message">May all your dreams come true.<br>I love you.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Beautiful Birthday Cake with Click Animation -->
  <div class="candle-container">
    <div class="cake" id="birthday-cake" onclick="blowOutCandle()">
      <div class="cake-base"></div>
      <div class="cake-middle"></div>
      <div class="cake-top"></div>
      <div class="frosting frosting-1"></div>
      <div class="frosting frosting-2"></div>
      <div class="frosting frosting-3"></div>
      <div class="frosting frosting-4"></div>
      <div class="frosting frosting-5"></div>
      <div class="frosting frosting-6"></div>
      <div class="sprinkle sprinkle-1"></div>
      <div class="sprinkle sprinkle-2"></div>
      <div class="sprinkle sprinkle-3"></div>
      <div class="sprinkle sprinkle-4"></div>
      <div class="sprinkle sprinkle-5"></div>
      <div class="sprinkle sprinkle-6"></div>
      <div class="candle">
        <div class="flame" id="candle-flame"></div>
      </div>
    </div>
  </div>
  
  <div id="love-notes-container"></div>

  <script>
  function createSakuraPetal() {
    const sakura = document.createElement('div');
    sakura.classList.add('sakura');
    sakura.style.left = Math.random() * 100 + 'vw';
    sakura.style.animationDuration = 5 + Math.random() * 5 + 's';
    document.getElementById('sakura-container').appendChild(sakura);

    setTimeout(() => {
      sakura.remove();
    }, 10000);
  }

  setInterval(createSakuraPetal, 400);
  </script>
  
  <script>
  const notes = [
    "You are my favorite human.",
    "Happy birthday, B 🌸",
    "I love the way you laugh.",
    "You make ordinary moments magical.",
    "My moon, in every phase.",
    "Forever yours, Carrots 🥕",
  ];

  function createLoveNote() {
    const note = document.createElement("div");
    note.classList.add("love-note");
    note.textContent = notes[Math.floor(Math.random() * notes.length)];

    note.style.left = Math.random() * 90 + "vw";
    note.style.fontSize = 1 + Math.random() * 1 + "rem";

    document.getElementById("love-notes-container").appendChild(note);

    setTimeout(() => {
      note.remove();
    }, 8000);
  }

  setInterval(createLoveNote, 3000); // One every 3 seconds
  </script>
  
  <script>
  // Birthday cake candle blowing animation with shooting stars
  function blowOutCandle() {
    const flame = document.getElementById('candle-flame');
    
    // Only proceed if the flame is still visible
    if (!flame.classList.contains('out')) {
      // Immediately hide the flame visually with direct style manipulation
      flame.style.opacity = '0';
      flame.style.transform = 'scale(0)';
      flame.style.filter = 'blur(5px)';
      
      // Add the out class to the flame for animation
      flame.classList.add('out');
      
      // Make sure the flame is actually hidden
      flame.style.display = 'none';
      
      // Play blowing sound
      const blowSound = new Audio('https://soundbible.com/mp3/Blow-SoundBible.com-893262371.mp3');
      blowSound.volume = 0.3;
      blowSound.play().catch(error => console.log('Could not play blow sound:', error));
      
      // Create a small smoke effect
      const candle = document.querySelector('.candle');
      const smoke = document.createElement('div');
      smoke.className = 'smoke';
      candle.appendChild(smoke);
      
      // Create celebration effects immediately but with a small visual delay
      setTimeout(() => {
        // Force browser to re-render first
        document.body.offsetHeight;
        
        // Create celebration effects
        createFireworks();
        
        // Remove smoke after fireworks start
        setTimeout(() => {
          smoke.remove();
        }, 2000);
      }, 100); // Reduced delay to ensure responsiveness
    }
  }
  
  function createFireworks() {
    console.log('Creating fireworks!');
    
    // Create a special firework at the candle position first
    const cake = document.getElementById('birthday-cake');
    const cakeRect = cake.getBoundingClientRect();
    const cakeX = cakeRect.left + cakeRect.width / 2;
    const cakeY = cakeRect.top;
    
    // Launch immediate firework from the cake
    launchFirework(cakeX, cakeY);
    
    // Play a special celebratory sound for the cake firework
    const celebrationSound = new Audio('https://soundbible.com/mp3/Ta Da-SoundBible.com-1884170640.mp3');
    celebrationSound.volume = 0.4;
    celebrationSound.play().catch(error => console.log('Could not play celebration sound:', error));
    
    // Create multiple firework starting points over 4 seconds
    for (let i = 0; i < 20; i++) {
      setTimeout(() => {
        const x = Math.random() * window.innerWidth;
        const y = window.innerHeight - (Math.random() * 200 + 100);
        launchFirework(x, y);
        
        // Play firework sound with random pitch for variety
        if (i % 3 === 0) { // Only play sound every 3rd firework to avoid audio overload
          const fireworkSound = new Audio('https://soundbible.com/mp3/Firework Explosion-SoundBible.com-1726302196.mp3');
          fireworkSound.volume = 0.2 + (Math.random() * 0.2); // Random volume between 0.2 and 0.4
          fireworkSound.playbackRate = 0.8 + (Math.random() * 0.4); // Random pitch
          fireworkSound.play().catch(error => console.log('Could not play firework sound:', error));
        }
      }, i * 200); // Spread out over 4 seconds (20 * 200ms = 4000ms)
    }
  }
  
  function launchFirework(x, y) {
    // Create the main firework explosion
    const firework = document.createElement('div');
    firework.classList.add('firework');
    firework.style.left = x + 'px';
    firework.style.top = y + 'px';
    document.body.appendChild(firework);
    
    // Animate the explosion with longer duration (1.5s instead of 0.5s)
    firework.style.animation = 'explode 1.5s forwards';
    
    // Create the particles that shoot out from the explosion
    const colors = ['#ffde59', '#ff5eb3', '#59b4ff', '#4dff8e', '#a158ff', '#ff8459'];
    
    // Create more particles for a more impressive effect
    for (let i = 0; i < 40; i++) {
      const particle = document.createElement('div');
      particle.classList.add('particle');
      
      // Random color from our palette
      const color = colors[Math.floor(Math.random() * colors.length)];
      particle.style.backgroundColor = color;
      
      // Add glowing effect to particles
      particle.style.boxShadow = `0 0 8px 2px ${color}80`; // 80 = 50% opacity
      
      // Position at the explosion center
      particle.style.left = x + 'px';
      particle.style.top = y + 'px';
      
      // Calculate random direction
      const angle = Math.random() * Math.PI * 2; // Random angle in radians
      const distance = 100 + Math.random() * 150; // Longer distance for more spread
      const duration = 1.5 + Math.random() * 2.5; // Longer duration (1.5-4s)
      
      // Calculate end position
      const endX = Math.cos(angle) * distance;
      const endY = Math.sin(angle) * distance;
      
      // Add random size for particles
      const size = 4 + Math.random() * 6; // Random size between 4-10px
      particle.style.width = size + 'px';
      particle.style.height = size + 'px';
      
      // Calculate a slightly different duration for each particle for more natural effect
      const particleDuration = duration + (Math.random() * 0.5); // Small variation
      
      // Set custom properties for the animation
      particle.style.setProperty('--endX', endX + 'px');
      particle.style.setProperty('--endY', endY + 'px');
      
      // Apply the animation directly with inline styles for reliability
      const keyframes = [
        { transform: `translate(-50%, -50%) scale(1)`, opacity: 1 },
        { transform: `translate(calc(-50% + ${endX}px), calc(-50% + ${endY}px)) scale(0.5)`, opacity: 0 }
      ];
      
      const animOptions = {
        duration: particleDuration * 1000,
        easing: 'ease-out',
        fill: 'forwards'
      };
      
      // Add to document
      document.body.appendChild(particle);
      
      // Start the animation
      particle.animate(keyframes, animOptions);
      
      // Remove the particle after animation
      setTimeout(() => {
        particle.remove();
      }, duration * 1000);
    }
    
    // Remove the firework element after longer animation
    setTimeout(() => {
      firework.remove();
    }, 1500); // Matches the 1.5s explosion animation
  }
  </script>
  
  <script>
  const canvas = document.getElementById("shooting-stars");
  const ctx = canvas.getContext("2d");

  let width = canvas.width = window.innerWidth;
  let height = canvas.height = window.innerHeight;

  window.addEventListener("resize", () => {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
  });

  class Star {
    constructor() {
      this.reset();
    }

    reset() {
      this.x = Math.random() * width;
      this.y = Math.random() * height;
      this.radius = Math.random() * 1.5;
      this.alpha = Math.random();
      this.alphaChange = 0.005 * (Math.random() > 0.5 ? 1 : -1);
    }

    update() {
      this.alpha += this.alphaChange;
      if (this.alpha <= 0 || this.alpha >= 1) {
        this.alphaChange *= -1;
      }
    }

    draw(ctx) {
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(255, 255, 255, ${this.alpha})`;
      ctx.fill();
    }
  }

  class ShootingStar {
    constructor() {
      this.reset();
    }

    reset() {
      this.x = Math.random() * width;
      this.y = Math.random() * height * 0.5;
      this.len = Math.random() * 80 + 10;
      this.speed = Math.random() * 8 + 3;
      this.angle = Math.PI / 4; // 45 degrees
      this.alpha = 1;
    }

    update() {
      this.x += this.speed * Math.cos(this.angle);
      this.y += this.speed * Math.sin(this.angle);
      this.alpha -= 0.01;

      if (this.alpha <= 0) {
        this.reset();
        this.alpha = 1;
      }
    }

    draw(ctx) {
      ctx.beginPath();
      ctx.moveTo(this.x, this.y);
      ctx.lineTo(this.x - this.len * Math.cos(this.angle), this.y - this.len * Math.sin(this.angle));
      ctx.strokeStyle = `rgba(255, 255, 255, ${this.alpha})`;
      ctx.lineWidth = 2;
      ctx.stroke();
    }
  }

  const backgroundStars = Array.from({ length: 150 }, () => new Star());
  const shootingStars = Array.from({ length: 8 }, () => new ShootingStar());

  function drawGradientBackground() {
    const gradient = ctx.createLinearGradient(0, 0, 0, height);
    gradient.addColorStop(0, "#0b0c1c");
    gradient.addColorStop(1, "#1b1e3f");
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, width, height);
  }

  function animate() {
    drawGradientBackground();

    for (let star of backgroundStars) {
      star.update();
      star.draw(ctx);
    }

    for (let s of shootingStars) {
      s.update();
      s.draw(ctx);
    }

    requestAnimationFrame(animate);
  }

  animate();
  </script>
  
  <!-- Fix for audio controls -->
  <script>
    // Fix audio controls
    window.addEventListener('load', function() {
      const audio = document.getElementById('birthday-music');
      const playBtn = document.querySelector('.play-btn');
      const progressBar = document.querySelector('.progress-bar');
      const volumeBtn = document.querySelector('.volume-btn');
      const volumeSlider = document.querySelector('.volume-slider');
      
      // Play button functionality
      playBtn.onclick = function() {
        if(audio.paused) {
          audio.play();
          this.innerHTML = '<i class="fas fa-pause"></i>';
        } else {
          audio.pause();
          this.innerHTML = '<i class="fas fa-play"></i>';
        }
      };
      
      // Update progress bar
      audio.ontimeupdate = function() {
        const progress = (audio.currentTime / audio.duration) * 100;
        progressBar.style.width = progress + '%';
      };
      
      // Volume control
      volumeSlider.oninput = function() {
        audio.volume = this.value;
      };
      
      // Mute button
      volumeBtn.onclick = function() {
        audio.muted = !audio.muted;
        if(audio.muted) {
          this.innerHTML = '<i class="fas fa-volume-mute"></i>';
        } else {
          this.innerHTML = '<i class="fas fa-volume-up"></i>';
        }
      };
    });
  </script>
</body>
</html>
